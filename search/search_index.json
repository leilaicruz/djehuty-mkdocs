{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to the Djehuty Documentation","text":"<p>Djehuty is the data repository system developed by and for 4TU.ResearchData. The name finds its inspiration in Thoth, the Egyptian entity that introduced the idea of writing.</p> <p></p>"},{"location":"api/","title":"Application Programming Interface","text":"<p>The application programming interface (API) provided by d\u0361jehuty allows for automating tasks otherwise done through the user interface. In addition to automation, the API can also be used to gather additional information, like statistics on Git repositories.</p> <p>Throughout this chapter we provide examples for using the API using c\u0361url and j\u0361q. Another way of seeing the API in action is to use the developer tools in a web browser while performing the desired action using the web user interface.</p>"},{"location":"api/#the-v2-public-interface","title":"The /\u0361v2 public interface","text":"<p>The v\u03612 API was designed by Figshare[^1]. d\u0361jehuty implements a backward-compatible version of it, with the following differences:</p> <ol> <li> <p>The i\u0361d property is superseded by the u\u0361uid property.</p> </li> <li> <p>Error handling is done through precise HTTP error codes, rather than     always returning 4\u036100 on a usage error.</p> </li> </ol> <p>Unless specified otherwise, the HTTP C\u0361ontent-Type to interact with the API is a\u0361pplication/json. In the case an API call returns information, don\u2019t forget to set the HTTP A\u0361ccept header appropriately.</p>"},{"location":"api/#v2articles-http","title":"/\u0361v2/articles (HTTP )","text":"<p>The following parameters can be used:</p> Parameter Required Description o\u0361rder Optional Field to use for sorting. o\u0361rder_direction Optional Can be either or . i\u0361nstitution Optional The institution identifier to filter on. p\u0361ublished_since Optional When set, datasets published before this timestamp are dropped from the results. m\u0361odified_since Optional When set, only datasets modified after this timestamp are shown from the results. g\u0361roup Optional The group identifier to filter on. r\u0361esource_doi Optional The DOI of the associated journal publication. When set, only returns datasets associated with this DOI. i\u0361tem_type Optional Either for datasets or for software. d\u0361oi Optional The DOI of the dataset to search for. h\u0361andle Optional Unused. p\u0361age Optional The page number used in combination with p\u0361age_size. p\u0361age_size Optional The number of datasets per page. Used in combination with p\u0361age. l\u0361imit Optional The maximum number of datasets to output. Used together with o\u0361ffset. o\u0361ffset Optional The number of datasets to skip in the output. Used together with l\u0361imit. <p>Example usage:</p> <pre><code>curl \"(@*\\djehutybaseurl{}*@)/v2/articles?limit=100&amp;published_since=2024-07-25\" | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[ /* Example output has been shortened. */\n  {\n    \"id\": null,\n    \"uuid\": \"4f8a9423-83fc-4263-9bb7-2aa83d73865d\",\n    \"title\": \"Measurement data of a Low Speed Field Test of Tractor Se...\",\n    \"doi\": \"10.4121/4f8a9423-83fc-4263-9bb7-2aa83d73865d.v1\",\n    \"handle\": null,\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/articles/4f8a...865d\",\n    \"published_date\": \"2024-07-26T10:39:57\",\n    \"thumb\": null,\n    \"defined_type\": 3,\n    \"defined_type_name\": \"dataset\",\n    \"group_id\": 28589,\n    \"url_private_api\": \"(@*\\djehutybaseurl{}*@)/v2/account/articles/4f8a...865d\",\n    \"url_public_api\": \"(@*\\djehutybaseurl{}*@)/v2/articles/4f8a...865d\",\n    \"url_private_html\": \"(@*\\djehutybaseurl{}*@)/my/datasets/4f8a...865d/edit\",\n    \"url_public_html\": \"(@*\\djehutybaseurl{}*@)/datasets/4f8a...865d/1\",\n    ...\n  }\n]\n</code></pre>"},{"location":"api/#v2articlessearch-http","title":"/\u0361v2/articles/search (HTTP )","text":"<p>In addition to the parameters of section , the following parameters can be used.</p> Parameter Required Description s\u0361earch_for Optional The terms to search for. <p>Example usage:</p> <pre><code>curl --request POST\\\n     --header \"Content-Type: application/json\"\\\n     --data '{ \"search_for\": \"djehuty\" }'\\\n     (@*\\djehutybaseurl{}*@)/v2/articles/search | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[ /* Example output has been shortened. */\n  {\n    \"id\": null,\n    \"uuid\": \"342efadc-66f8-4e9b-9d27-da7b28b849d2\",\n    \"title\": \"Source code of the 4TU.ResearchData repository\",\n    \"doi\": \"10.4121/342efadc-66f8-4e9b-9d27-da7b28b849d2.v1\",\n    \"handle\": null,\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/articles/342e...49d2\",\n    \"published_date\": \"2023-03-20T11:29:10\",\n    \"thumb\": null,\n    \"defined_type\": 9,\n    \"defined_type_name\": \"software\",\n    \"group_id\": 28586,\n    \"url_private_api\": \"(@*\\djehutybaseurl{}*@)/v2/account/articles/342e...49d2\",\n    \"url_public_api\": \"(@*\\djehutybaseurl{}*@)/v2/articles/342e...49d2\",\n    \"url_private_html\": \"(@*\\djehutybaseurl{}*@)/my/datasets/342e...49d2/edit\",\n    \"url_public_html\": \"(@*\\djehutybaseurl{}*@)/datasets/342e...49d2/1\",\n    ...\n  }\n]\n</code></pre>"},{"location":"api/#v2articlesdataset-id-http","title":"/\u0361v2/articles/\\&lt;dataset-id&gt; (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/articles/342efadc-66f8-4e9b-9d27-da7b28b849d2 | jq\n</code></pre> <p>Output of the example:</p> <pre><code>{ /* Example output has been shortened. */\n  \"files\": ...,\n  \"custom_fields\": ...,\n  \"authors\": ...,\n  \"description\": \"&lt;p&gt;This dataset contains the source code of the 4TU...\",\n  \"license\": ...,\n  \"tags\": ...,\n  \"categories\": ...,\n  \"references\": ...,\n  \"id\": null,\n  \"uuid\": \"342efadc-66f8-4e9b-9d27-da7b28b849d2\",\n  \"title\": \"Source code of the 4TU.ResearchData repository\",\n  \"doi\": \"10.4121/342efadc-66f8-4e9b-9d27-da7b28b849d2.v1\",\n  \"url\": \"(@*\\djehutybaseurl{}*@)/v2/articles/342e...49d2\",\n  \"published_date\": \"2023-03-20T11:29:10\",\n  \"timeline\": ...,\n  ...\n}\n</code></pre>"},{"location":"api/#v2articlesdataset-idversions-http","title":"/\u0361v2/articles/\\&lt;dataset-id&gt;/versions (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/articles/342efadc-66f8-4e9b-9d27-da7b28b849d2/versions | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[\n  {\n    \"version\": 1,\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/articles/342efadc-66f8-4e9b-9d27-da7b28b849d2/versions/1\"\n  }\n]\n</code></pre>"},{"location":"api/#v2articlesdataset-idversionsversion-http","title":"/\u0361v2/articles/\\&lt;dataset-id&gt;/versions/\\&lt;version&gt; (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/articles/342efadc-66f8-4e9b-9d27-da7b28b849d2/versions/1 | jq\n</code></pre> <p>The output of the example is identical to the example output of section .</p>"},{"location":"api/#v2articlesdataset-idversionsversionembargo-http","title":"/\u0361v2/articles/\\&lt;dataset-id&gt;/versions/\\&lt;version&gt;/embargo (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/articles/c1274889-b797-43bd-a3b1-ee0611d58fd7/versions/2/embargo | jq\n</code></pre> <p>Output of the example:</p> <pre><code>{\n  \"is_embargoed\": true,\n  \"embargo_date\": \"2039-06-30\",\n  \"embargo_type\": \"article\",\n  \"embargo_title\": \"Under embargo\",\n  \"embargo_reason\": \"&lt;p&gt;Need consent to publish the data&lt;/p&gt;\",\n  \"embargo_options\": []\n}\n</code></pre>"},{"location":"api/#v2articlesdataset-idfiles-http","title":"/\u0361v2/articles/\\&lt;dataset-id&gt;/files (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/articles/342efadc-66f8-4e9b-9d27-da7b28b849d2/files\n</code></pre> <p>Output of the example:</p> <pre><code>[ /* Example output has been shortened. */\n  {\n    \"id\": null,\n    \"uuid\": \"d3e1c325-7fa9-4cb9-884e-0b9cd2059292\",\n    \"name\": \"djehuty-0.0.1.tar.gz\",\n    \"size\": 3713709,\n    \"is_link_only\": false,\n    \"is_incomplete\": false,\n    \"download_url\": \"(@*\\djehutybaseurl{}*@)/file/342e...49d2/d3e1...9292\",\n    \"supplied_md5\": null,\n    \"computed_md5\": \"910e9b0f79a0af548f59b3d8a56c3bf4\"\n  }\n]\n</code></pre>"},{"location":"api/#v2articlesdataset-idfilesfile-id-http","title":"/\u0361v2/articles/\\&lt;dataset-id&gt;/files/\\&lt;file-id&gt; (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/articles/342e...49d2/files/d3e1...9292 | jq\n</code></pre> <p>Output of the example:</p> <pre><code>{ /* Example output has been shortened. */\n  \"id\": null,\n  \"uuid\": \"d3e1c325-7fa9-4cb9-884e-0b9cd2059292\",\n  \"name\": \"djehuty-0.0.1.tar.gz\",\n  \"size\": 3713709,\n  \"is_link_only\": false,\n  \"is_incomplete\": false,\n  \"download_url\": \"(@*\\djehutybaseurl{}*@)/file/342e...49d2/d3e1...9292\",\n  \"supplied_md5\": null,\n  \"computed_md5\": \"910e9b0f79a0af548f59b3d8a56c3bf4\"\n}\n</code></pre>"},{"location":"api/#v2collections-http","title":"/\u0361v2/collections (HTTP )","text":"<p>The following parameters can be used:</p> Parameter Required Description o\u0361rder Optional Field to use for sorting. o\u0361rder_direction Optional Can be either or . i\u0361nstitution Optional The institution identifier to filter on. p\u0361ublished_since Optional When set, collections published before this timestamp are dropped from the results. m\u0361odified_since Optional When set, only collections modified after this timestamp are shown from the results. g\u0361roup Optional The group identifier to filter on. r\u0361esource_doi Optional The DOI of the associated journal publication. When set, only returns collections associated with this DOI. d\u0361oi Optional The DOI of the collection to search for. h\u0361andle Optional Unused. p\u0361age Optional The page number used in combination with p\u0361age_size. p\u0361age_size Optional The number of collections per page. Used in combination with p\u0361age. l\u0361imit Optional The maximum number of collections to output. Used together with o\u0361ffset. o\u0361ffset Optional The number of collections to skip in the output. Used together with l\u0361imit. <p>Example usage:</p> <pre><code>curl \"(@*\\djehutybaseurl{}*@)/v2/collections?limit=100&amp;published_since=2024-07-25\" | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[ /* Example output has been shortened. */\n  {\n    \"id\": null,\n    \"uuid\": \"0fe9ab80-6e6a-4087-a509-ce09dddfa3d9\",\n    \"title\": \"PhD research 'Untangling the complexity of local water ...'\",\n    \"doi\": \"10.4121/0fe9ab80-6e6a-4087-a509-ce09dddfa3d9.v1\",\n    \"handle\": \"\",\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/collections/0fe9...fa3d9\",\n    \"timeline\": {\n      \"posted\": \"2024-08-13T14:09:52\",\n      \"firstOnline\": \"2024-08-13T14:09:51\",\n      ...\n    },\n    \"published_date\": \"2024-08-13T14:09:52\"\n  },\n  ...\n]\n</code></pre>"},{"location":"api/#v2collectionssearch-http","title":"/\u0361v2/collections/search (HTTP )","text":"<p>In addition to the parameters of section , the following parameters can be used.</p> Parameter Required Description s\u0361earch_for Optional The terms to search for. <p>Example usage:</p> <pre><code>curl --request POST\\\n     --header \"Content-Type: application/json\"\\\n     --data '{ \"search_for\": \"wingtips\" }'\\\n     (@*\\djehutybaseurl{}*@)/v2/collections/search | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[  /* Example output has been shortened. */\n  {\n    \"id\": 6070238,\n    \"uuid\": \"3dfc4ef2-7f79-4d33-81a7-9c6ae09a2782\",\n    \"title\": \"Flared Folding Wingtips - TU Delft\",\n    \"doi\": \"10.4121/c.6070238.v1\",\n    \"handle\": \"\",\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/collections/3dfc...2782\",\n    \"timeline\": {\n      \"posted\": \"2023-04-05T15:05:04\",\n      \"firstOnline\": \"2023-04-05T15:05:03\",\n      ...\n    },\n    \"published_date\": \"2023-04-05T15:05:04\"\n  },\n  ...\n]\n</code></pre>"},{"location":"api/#v2collectionscollection-id-http","title":"/\u0361v2/collections/\\&lt;collection-id&gt; (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/collections/3dfc4ef2-7f79-4d33-81a7-9c6ae09a2782 | jq\n</code></pre> <p>Output of the example:</p> <pre><code>{ /* Example output has been shortened. */\n  \"version\": 3,\n  ...\n  \"description\": \"&lt;p&gt;This collection contains the results of the work ...\",\n  \"categories\": [ ... ],\n  \"references\": [],\n  \"tags\": [ ... ],\n  \"created_date\": \"2024-08-08T15:48:55\",\n  \"modified_date\": \"2024-08-12T11:24:39\",\n  \"id\": 6070238,\n  \"uuid\": \"3dfc4ef2-7f79-4d33-81a7-9c6ae09a2782\",\n  \"title\": \"Flared Folding Wingtips - TU Delft\",\n  \"doi\": \"10.4121/c.6070238.v3\",\n  \"published_date\": \"2024-08-12T11:24:40\",\n  \"timeline\": ...\n  ...\n}\n</code></pre>"},{"location":"api/#v2collectionscollection-idversions-http","title":"/\u0361v2/collections/\\&lt;collection-id&gt;/versions (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/collections/3dfc4ef2-7f79-4d33-81a7-9c6ae09a2782/versions | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[ /* Example output has been shortened. */\n  {\n    \"version\": 3,\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/collections/3dfc...2782/versions/3\"\n  },\n  {\n    \"version\": 2,\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/collections/3dfc...2782/versions/2\"\n  },\n  {\n    \"version\": 1,\n    \"url\": \"(@*\\djehutybaseurl{}*@)/v2/collections/3dfc...2782/versions/1\"\n  }\n]\n</code></pre>"},{"location":"api/#v2collectionscollection-idversionsversion-http","title":"/\u0361v2/collections/\\&lt;collection-id&gt;/versions/\\&lt;version&gt; (HTTP )","text":"<p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/collections/3dfc4ef2-7f79-4d33-81a7-9c6ae09a2782/versions/2 | jq\n</code></pre> <p>Output of the example:</p> <pre><code>{ /* Example output has been shortened. */\n  \"version\": 2,\n  ...\n  \"description\": \"&lt;p&gt;This collection contains the results of the work ...\",\n  \"categories\": [ ... ],\n  \"references\": [],\n  \"tags\": [ ... ],\n  \"references\": [],\n  \"tags\": [ ... ],\n  \"authors\": [ ... ],\n  \"created_date\": \"2023-04-05T15:07:35\",\n  \"modified_date\": \"2023-05-26T15:19:11\",\n  \"id\": 6070238,\n  \"uuid\": \"3dfc4ef2-7f79-4d33-81a7-9c6ae09a2782\",\n  \"title\": \"Flared Folding Wingtips - TU Delft\",\n  \"doi\": \"10.4121/c.6070238.v2\",\n  ...\n}\n</code></pre>"},{"location":"api/#v2categories-http","title":"/\u0361v2/categories (HTTP )","text":"<p>Each dataset and collection is categorized using a controlled vocabulary of categories. This API endpoint provides those categories.</p> <p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/categories | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[ /* Example output has been shortened. */\n  {\n    \"id\": 13622,\n    \"uuid\": \"01fddd41-68d2-4e28-9d9c-18347847e7d1\",\n    \"title\": \"Mining and Extraction of Energy Resources\",\n    \"parent_id\": 13620,\n    \"parent_uuid\": \"6e5bdc69-96db-41e4-ac0b-18812b46c49c\",\n    \"path\": \"\",\n    \"source_id\": null,\n    \"taxonomy_id\": null\n  },\n  {\n    \"id\": 13443,\n    \"uuid\": \"026f555c-2826-4a83-97ff-0f230fb54ddb\",\n    \"title\": \"Livestock Raising\",\n    \"parent_id\": 13440,\n    \"parent_uuid\": \"45a8c849-ab59-4302-af79-09b8c0677df8\",\n    \"path\": \"\",\n    \"source_id\": null,\n    \"taxonomy_id\": null\n  },\n  ...\n]\n</code></pre>"},{"location":"api/#v2licenses-http","title":"/\u0361v2/licenses (HTTP )","text":"<p>Publishing a dataset involves communicating under which conditions it can be re-used. The licenses under which you can publish a dataset can be found with this API endpoint.</p> <p>Example usage:</p> <pre><code>curl (@*\\djehutybaseurl{}*@)/v2/licenses | jq\n</code></pre> <p>Output of the example:</p> <pre><code>[ /* Example output has been shortened. */\n  {\n    \"value\": 1,\n    \"name\": \"CC BY 4.0\",\n    \"url\": \"https://creativecommons.org/licenses/by/4.0/\",\n    \"type\": \"data\"\n  },\n  {\n    \"value\": 10,\n    \"name\": \"CC BY-NC 4.0\",\n    \"url\": \"https://creativecommons.org/licenses/by-nc/4.0/\",\n    \"type\": \"data\"\n  },\n  ...\n]\n</code></pre>"},{"location":"api/#the-v2-private-interface","title":"The /\u0361v2 private interface","text":"<p>The interaction with the v\u03612 private interface API requires an API token. Such a token can be obtained from the dashboard page after logging in. This token can then be passed along in the A\u0361uthorization HTTP header as:</p> <pre><code>Authorization: token YOUR_TOKEN_HERE\n</code></pre>"},{"location":"api/#v2accountarticles-http","title":"/\u0361v2/account/articles (HTTP )","text":"<p>This API endpoint lists the draft datasets of the account to which the authorization token belongs.</p> <p>The following parameters can be used:</p> Parameter Required Description p\u0361age Optional The page number used in combination with p\u0361age_size. p\u0361age_size Optional The number of datasets per page. Used in combination with p\u0361age. l\u0361imit Optional The maximum number of datasets to output. Used together with o\u0361ffset. o\u0361ffset Optional The number of datasets to skip in the output. Used together with l\u0361imit. <p>Example usage:</p> <pre><code>curl -H \"Authorization: token YOUR_TOKEN_HERE\" (@*\\djehutybaseurl{}*@)/v2/account/articles | jq\n</code></pre> <p>Output of the example:</p> <pre><code>{ /* Example output has been shortened. */\n  \"id\": null,\n  \"uuid\": \"6ddd7a31-8ad8-4c20-95a3-e68fe716fa42\",\n  \"title\": \"Example draft dataset\",\n  \"doi\": null,\n  \"handle\": null,\n  \"url\": \"(@*\\djehutybaseurl{}*@)/v2/articles/6ddd7a31-8ad8-4c20-95a3-e68fe716fa42\",\n  \"published_date\": null,\n  ...\n}\n</code></pre>"},{"location":"api/#v2accountarticles-http_1","title":"/\u0361v2/account/articles (HTTP )","text":"<p>This API endpoint can be used to create a new dataset.</p> <p>The following parameters can be used:</p> Parameter Data type Description t\u0361itle s\u0361tring The title of the dataset. d\u0361escription s\u0361tring A description of the dataset. t\u0361ags list of s\u0361trings Keywords to enhance the findability of the dataset. Instead of using the key , you may also use the key . r\u0361eferences list of s\u0361trings URLs to resources referring to this dataset, or resources that this dataset refers to. c\u0361ategories list of s\u0361trings Categories are a controlled vocabulary and can be used to make the dataset findable in the categorical overviews. The s\u0361tring values expected here can be found under the property with a call to . For more details, see section . a\u0361uthors list of author records d\u0361efined_type s\u0361tring One of: f\u0361igure, o\u0361nline resource, p\u0361reprint, b\u0361ook, c\u0361onference contribution, m\u0361edia, d\u0361ataset, p\u0361oster, j\u0361ournal contribution, p\u0361resentation, t\u0361hesis or s\u0361oftware. f\u0361unding s\u0361tring One-liner to cite funding. f\u0361unding_list list of funding records l\u0361icense i\u0361nteger Licences communicate under which conditions the dataset can be re-used. The i\u0361nteger value to submit here can be found as the v\u0361alue property in a call to . For more details, see section . d\u0361oi s\u0361tring Do not use this field as a DOI will be automatically assigned upon publication.. h\u0361andle s\u0361tring Do not use this field as it is deprecated. r\u0361esource_doi s\u0361tring The URL of the DOI of an associated peer-reviewed journal publication. r\u0361esource_title s\u0361tring The title of the associated peer-reviewed journal publication. p\u0361ublisher s\u0361tring The name of the data repository publishing the dataset. c\u0361ustom_fields list of key-value pairs t\u0361imeline Do not use this field because it will be automatically populated during the publication process. <p>[^1]:</p>"},{"location":"configuration/","title":"Configuration","text":""},{"location":"configuration/#chapter-2configuring-djehuty","title":"Chapter\u00a02Configuring djehuty","text":"<p>Now that djehuty is installed, it\u2019s a good moment to look into its run-time configuration options. All configuration can be done through a configuration file, for which an example is available at \u2018etc/djehuty/djehuty-example-config.xml\u2019.</p>"},{"location":"configuration/#21-essential-options","title":"2.1  Essential options","text":"<p>| Option | Description | | bind-address | The address to bind a TCP socket on. | | port | The port to bind a TCK socket on. | | base-url | The URL on which the instance will be available to the outside  world. | | allow-crawlers | Set to 1 to allow crawlers in the robots.txt, otherwise set to  0. | | production | Performs extra checks before starting. Enable this when  running a production instance. | | live-reload | When set to 1, it reloads Python code on-the-fly. We  recommend to set it to 0 when running in production. | | debug-mode | When set to 1, it will display backtraces and error messages in  the web browser. When set to 0, it will only show backtraces  and error messages in the web browser. | | use-x-forwarded-for | When running djehuty behind a reverse-proxy server, use the  HTTP header X-Forwarded-For to log IP address information. | | disable-collaboration | When set to 1, it disables the \u201ccollaborators\u201d feature. | | restrict-depositing-to-domain | By default, any authenticated user may deposit data. This  option limits the ability to deposit to users with an e-mail  address of a specific domain name. | | cache-root | djehuty can cache query responses to lower the load on the  database server. Specify the directory where to store cache files.  This element takes an attribute clear-on-start, and when  set to 1, it will remove all cache files on start-up of djehuty. | | profile-images-root | Users can upload a profile image in djehuty. This option  should point to a filesystem directory where these profile  images can be stored. | | disable-2fa | Accounts with privileges receive a code by e-mail as a second  factor when logging in. Setting this option to 1 disables the  second factor authentication. | | sandbox-message | Display a message on the top of every page. | | notice-message | Display a message on the main page. | | maintenance-mode | When set to 1, all HTTP requests result in the displayment of  a maintenance message. Use this option while backing up the  database, or when performing major updates. | |  |</p>"},{"location":"configuration/#22-configuring-the-database","title":"2.2  Configuring the Database","text":"<p>The djehuty program stores its state in a SPARQL 1.1 compliant RDF store. Configuring the connection details is done in the rdf-store node.</p> <p>| Option | Description | | state-graph | The graph name to store triplets in. | | sparql-uri | The URI at which the SPARQL 1.1 endpoint can be reached.When the sparql-uri begins with bdb://, followed by a  path to a filesystem directory, it will use the BerkeleyDB  back-end, for which the berkeleydb Python package needs to  be installed. | | sparql-update-uri | The URI at which the SPARQL 1.1 Update endpoint can be  reached (in case it is different from the sparql-uri. | |  |</p>"},{"location":"configuration/#23-audit-trails-and-database-reconstruction","title":"2.3  Audit trails and database reconstruction","text":"<p>The djehuty program can keep an audit log of all database modifications made by itself from which a database state can be reconstructed. Whether djehuty keeps such an audit log can be configured with the following option:</p> <p>| Option | Description | | enable-query-audit-log | When set to 1, it writes every SPARQL query that modifies  the database in the web logs. This can be replayed to  reconstruct the database at a later time. Setting this option  to 0 disables this feature. This element takes an attribute  transactions-directory that should specify an empty  directory to which transactions can be written that are  extracted from the audit log. | |  |</p>"},{"location":"configuration/#231-reconstructing-the-database-from-the-query-audit-log","title":"2.3.1  Reconstructing the database from the query audit log","text":"<p>Each query that modifies the database state while the query audit logs are enabled can be extracted from the query audit log using the --extract-transactions-from-log command-line option. A timestamp to specify the starting point to extract from can be specified as an argument. The following example displays its use:</p> <pre><code>djehuty web --config-file=config.xml --extract-transactions-from-log=\"YYYY-MM-DD HH:MM:SS\"\n</code></pre> <p>This will create a file for each query in the folder specified in the transactions-directory attribute.</p> <p>To replay the extracted transactions, use the apply-transactions command-line option: </p> <pre><code>djehuty web --config-file=config.xml --apply-transactions\n</code></pre> <p>When a query cannot be executed, the command stops, allowing to fix or remove the query to-be-replayed. Invoking the --apply-transactions command a second time will continue replaying where the previous run stopped.</p>"},{"location":"configuration/#24-configuring-storage","title":"2.4  Configuring storage","text":"<p>Storage locations can be configured with the storage node. When configuring multiple locations, djehuty attempts to find a file by looking at the first configured location, and in case it cannot find the file there, it will look at the second configured location, and so on, until it has tried each storage location. This allows for moving files between storage systems transparently without requiring specific interactions with djehuty other than having the files made available as a POSIX filesystem. One use-case that suits this mechanism is letting uploads write to fast online storage and later move the uploaded files to a slower but less costly storage.</p> <p>| Option | Description | | location | A filesystem path to where files are stored. This is a repeatable  property. | |  |</p>"},{"location":"configuration/#25-configuring-an-identity-provider","title":"2.5  Configuring an identity provider","text":"<p>Ideally, djehuty makes use of an external identity provider. djehuty can use SAML2.0, ORCID, or an internal identity provider (for testing and development purposes only). This section will outline the configuration options for each identity provision mechanism.</p>"},{"location":"configuration/#251-saml20","title":"2.5.1  SAML2.0","text":"<p>For SAML 2.0, the configuration can be placed in the saml section under authentication. That looks as following:</p> <pre><code>&lt;authentication&gt; \n  &lt;saml version=\"2.0\"&gt; \n    &lt;!-- Configuration goes here. --&gt; \n  &lt;/saml&gt; \n&lt;/authentication&gt;\n</code></pre> <p>The options outlined in the remainder of this section should be placed where the example shows \\&lt;!\u2013 Configuration goes here. \u2013&gt;.</p> <p>| Option | Description | | strict | When set to 1, SAML responses must be signed. Never disable \u2018strict\u2019 mode in a production environment. | | debug | Increases logging verbosity for SAML-related messages. | | attributes | In this section the attributes provided by the identity provider  can be aligned to the attributes djehuty expects. | | service-provider | The djehuty program fulfills the role of service provider. In  this section the certificate and service provider metadata can  be configured. | | identity-provider | In this section the certificate and single-sign-on URL of the  identity provider can be configured. | | sram | In this section, SURF Research Access Management-specific  attributes can be configured. | |  |</p>"},{"location":"configuration/#the-attributes-configuration","title":"The attributes configuration","text":"<p>To create account and author records and to authenticate a user, djehuty stores information provided by the identity provider. Each identity provider may provide this information using different attributes. Therefore, the translation from attributes used by djehuty and attributes given by the identity provider can be configured. The following attributes must be configured.</p> <p>| Option | Description | | first-name | A user\u2019s first name. | | last-name | A user\u2019s last name. | | common-name | A user\u2019s full name. | | email | A user\u2019s e-mail address. | | groups | The attribute denoting groups. | | group-prefix | The prefix for each group short name. | |  |</p> <p>As an example, the attributes configuration for SURFConext looks like this:</p> <pre><code>&lt;attributes&gt; \n  &lt;first-name&gt;urn:mace:dir:attribute-def:givenName&lt;/first-name&gt; \n  &lt;last-name&gt;urn:mace:dir:attribute-def:sn&lt;/last-name&gt; \n  &lt;common-name&gt;urn:mace:dir:attribute-def:cn&lt;/common-name&gt; \n  &lt;email&gt;urn:mace:dir:attribute-def:mail&lt;/email&gt; \n&lt;/attributes&gt;\n</code></pre> <p>And for SURF Research Access Management (SRAM), the attributes configuration looks like this:</p> <pre><code>&lt;attributes&gt; \n  &lt;first-name&gt;urn:oid:2.5.4.42&lt;/first-name&gt; \n  &lt;last-name&gt;urn:oid:2.5.4.4&lt;/last-name&gt; \n  &lt;common-name&gt;urn:oid:2.5.4.3&lt;/common-name&gt; \n  &lt;email&gt;urn:oid:0.9.2342.19200300.100.1.3&lt;/email&gt; \n  &lt;groups&gt;urn:oid:1.3.6.1.4.1.5923.1.1.1.7&lt;/groups&gt; \n  &lt;group-prefix&gt;urn:mace:surf.nl:sram:group:[organisation]:[service]&lt;/group-prefix&gt; \n&lt;/attributes&gt;\n</code></pre>"},{"location":"configuration/#the-sram-configuration","title":"The sram configuration","text":"<p>When using SURF Research Access Management (SRAM), djehuty can persuade SRAM to send an invitation to anyone inside or outside the institution to join the SRAM collaboration that provides access to the djehuty instance. To do so, the following attributes must be configured.</p> <p>| Option | Description | | organization-api-token | An organization-level API token. | | collaboration-id | The UUID of the collaboration to invite users to. | |  |</p>"},{"location":"configuration/#the-service-provider-configuration","title":"The service-provider configuration","text":"<p>| Option | Description | | x509-certificate | Contents of the public certificate without whitespacing. | | private-key | Contents  of the private key belonging to the x509-certificate to sign  messages with. | | metadata | This section contains metadata that may be displayed by the  identity provider to users before authorizing them. | | display-name | The name to be displayed by the identity provider when  authorizing the user to the service. | | url | The URL to the service. | | description | Textual description of the service. | | organization | This section contains metadata to describe the organization  behind the service. | | name | The name of the service provider\u2019s organization. | | url | The URL to the web page of the organization. | | contact | A repeatable section to list contact persons and their roles  within the organization. The role can be configured by setting  the type attribute. | | first-name | The first name of the contact person. | | last-name | The last name of the contact person. | | email | The e-mail address of the contact person. Note that some  identity providers prefer functional e-mail addresses (e.g.  support@... instead of jdoe@...). | |  |</p>"},{"location":"configuration/#252-orcid","title":"2.5.2  ORCID","text":"<p>ORCID.org plays a key role in making researchers findable. Its identity provider service can be used by djehuty in two ways:</p> <p>1. As primary identity provider to log in and deposit data;</p> <p>2. As additional identity provider to couple an author record to its ORCID record. When another identity provider is configured in addition to ORCID, that identity provider will be used as primary and ORCID will only be used to couple author records to the author\u2019s ORCID record. To configure ORCID, the configuration can be placed in the orcid section under authentication. That looks as following:</p> <pre><code>&lt;authentication&gt; \n  &lt;orcid&gt; \n    &lt;!-- Configuration goes here. --&gt; \n  &lt;/orcid&gt; \n&lt;/authentication&gt;\n</code></pre> <p>Then the following parameters can be configured:</p> <p>| Option | Description | | client-id | The client ID provided by ORCID. | | client-secret | The client secret provided by ORCID. | | endpoint | The URL to the ORCID endpoint to use. | |  |</p>"},{"location":"configuration/#26-configuring-an-e-mail-server","title":"2.6  Configuring an e-mail server","text":"<p>On various occassions, djehuty will attempt to send an e-mail to either an author, a reviewer or an administrator. To be able to do so, an e-mail server must be configured from which the instance may send e-mails. The configuration is done under the email node, and the following items can be configured:</p> <p>| Option | Description | | server | Address of the e-mail server without protocol specification. | | port | The port the e-mail server operates on. | | starttls | When 1, djehuty attempts to use StartTLS. | | username | The username to authenticate with to the e-mail server. | | password | The password to authenticate with to the e-mail server. | | from | The e-mail address used to send e-mail from. | | subject-prefix | Text to prefix in the subject of all e-mails sent from the  instance of djehuty. This can be used to distinguish a test  instance from a production instance. | |  |</p>"},{"location":"configuration/#27-configuring-doi-registration","title":"2.7  Configuring DOI registration","text":"<p>When publishing a dataset or collection, djehuty can register a persistent identifier with DataCite. To enable this feature, configure it under the datacite node. The following parameters can be configured:</p> <p>| Option | Description | | api-url | The URL of the API endpoint of DataCite. | | repository-id | The repository identifier given by DataCite. | | password | The password to authenticate with to DataCite. | | prefix | The DOI prefix to use when registering a DOI. | |  |</p>"},{"location":"configuration/#28-configuring-handle-registration","title":"2.8  Configuring Handle registration","text":"<p>Each uploaded file can be assigned a persistent identifier using the Handle system. To enable this feature, configure it under the handle node. The following parameters can be configured:</p> <p>| Option | Description | | url | The URL of the API endpoint of the Handle system  implementor. | | certificate | Certificate to use for authenticating to the endpoint. | | private-key | The private key paired with the certificate used to authenticate  to the endpoint. | | prefix | The Handle prefix to use when registering a handle. | | index | The index to use when registering a handle. | |  |</p>"},{"location":"configuration/#29-configuring-iiif-support","title":"2.9  Configuring IIIF support","text":"<p>When publishing images, djehuty can enable the IIIF Image API for the images. It uses libvips and pyvips under the hood to perform image manipulation. The following parameters can be configured:</p> <p>| Option | Description | | enable-iiif | Enable support for the IIIF image API. This requires the  pyvips package to be available in the run-time environment. | | iiif-cache-root | The directory to store the output of IIIF Image API requests  to avoid re-computing the image. | |  |</p>"},{"location":"configuration/#210-customizing-looks","title":"2.10  Customizing looks","text":"<p>With the following options, the instance can be branded as necessary.</p> <p>| Option | Description | | site-name | Name for the instance used in the title of a browser window  and as default value in the publisher field for new datasets. | | site-description | Description used as a meta-tag in the HTML output. | | site-shorttag | Used as keyword and as Git remote name. | | support-email-address | E-mail address used in e-mails sent to users in automated  messages. | | custom-logo-path | Path to a PNG image file that will be used as logo on the  website. | | custom-favicon-path | Path to an ICO file that will be used as favicon. | | small-footer | HTML that will be used as footer for all pages except for the  main page. | | large-footer | HTML that will be used as footer on the main page. | | show-portal-summary | When set to 1, it shows the repository summary of number of  datasets, authors, collections, files and bytes on the main page. | | show-institutions | When set to 1, it shows the list of institutions on the main  page. | | show-science-categories | When set to 1, it shows the subjects (categories) on the main  page. | | show-latest-datasets | When set to 1, it shows the list of latest published datasets on  the main page. | | colors | Colors used in the HTML output. See section 2.10.1. | |  |</p>"},{"location":"configuration/#2101-customizing-colors","title":"2.10.1  Customizing colors","text":"<p>The following options can be configured in the colors section.</p> <p>| Option | Description | | primary-color | The main background color to use. | | primary-foreground-color | The main foreground color to use. | | primary-color-hover | Color to use when hovering a link. | | primary-color-active | Color to use when a link is clicked. | | privilege-button-color | The background color of buttons for privileged actions. | | footer-background-color | Color to use in the footer. | |  |</p>"},{"location":"configuration/#211-configuring-privileged-users","title":"2.11  Configuring privileged users","text":"<p>By default an authenticated user may deposit data. But users can have additional roles; for example: a dataset reviewer, a technical administrator or a quota reviewer. Such additional roles are configured in terms of privileges. The following privileges can be configured in the privileges section:</p> <p>| Option | Description | | may-administer | Allows access to perform maintenance tasks, view accounts and  view reports on restricted and embargoed datasets. | | may-run-sparql-queries | Allows to run arbitrary SPARQL queries on the database. | | may-impersonate | Allows to log in to any account and therefore perform any  action as that account. | | may-review | Allows to see which datasets are sent for review, and allows to  perform reviews. | | may-review-quotas | Allows access to see requests for storage quota increases and  approve or decline them. | | may-review-integrity | Allows access to an API call that provides statistics on the  accessibility of files on the filesystem. | | may-process-feedback | Accounts with this privilege will receive e-mails with the  information entered into the feedback form by other users. | | may-receive-email-notifications | This \u201cprivilege\u201d can be used to disable sending any e-mails to  an account by setting it to 0. The default is 1. | |  |</p> <p>To enable a privilege for an account, set the value of the desired privilege to 1. Privileges are disabled by default, except for may-receive-email-notifications which defaults to 1.</p> <pre><code>  &lt;privileges&gt; \n    &lt;account email=\"you@example.com\" orcid=\"0000-0000-0000-0001\"&gt; \n      &lt;may-administer&gt;1&lt;/may-administer&gt; \n      &lt;may-run-sparql-queries&gt;1&lt;/may-run-sparql-queries&gt; \n      &lt;may-impersonate&gt;1&lt;/may-impersonate&gt; \n      &lt;may-review&gt;0&lt;/may-review&gt; \n      &lt;may-review-quotas&gt;0&lt;/may-review-quotas&gt; \n      &lt;may-review-integrity&gt;0&lt;/may-review-integrity&gt; \n      &lt;may-process-feedback&gt;0&lt;/may-process-feedback&gt; \n      &lt;may-receive-email-notifications&gt;1&lt;/may-receive-email-notifications&gt; \n    &lt;/account&gt; \n  &lt;/privileges&gt;\n</code></pre>"},{"location":"contributing/","title":"Contributing","text":"<p>This chapter outlines how to set up an instance of d\u0361jehuty with the goal of modifying its source code. Or in other words: this is the developer setup.</p>"},{"location":"contributing/#setting-up-a-development-environment","title":"Setting up a development environment","text":"<p>First, we need to obtain the latest version of the source code:</p> <pre><code>$ git clone https://github.com/4TUResearchData/djehuty.git\n</code></pre> <p>Next, we need to create a somewhat isolated Python environment:</p> <pre><code>$ python -m venv djehuty-env\n$ . djehuty-env/bin/activate\n[env]$ cd djehuty\n[env]$ pip install -r requirements.txt\n</code></pre> <p>And finally, we can install d\u0361jehuty in the virtual environment to make the d\u0361jehuty command available:</p> <pre><code>[env]$ sed -e 's/@VERSION@/0.0.1/g' pyproject.toml.in &gt; pyproject.toml\n[env]$ pip install --editable .\n</code></pre> <p>If all went well, we will now be able to run d\u0361jehuty:</p> <pre><code>[env]$ djehuty --help\n</code></pre>"},{"location":"contributing/#configuring-djehuty","title":"Configuring d\u0361jehuty","text":"<p>Invoking d\u0361jehuty web starts the web interface of d\u0361jehuty. On what port it makes itself available can be configured in its configuration file. An example of a configuration file can be found in . We will use the example configuration as the basis to configure it for the development environment.</p> <pre><code>[env]$ cp etc/djehuty/djehuty-example-config.xml config.xml\n</code></pre> <p>In the remainder of the chapter we will assume a value of 1\u036127.0.0.1 for b\u0361ind-address and a value of 8\u0361080 for p\u0361ort.</p>"},{"location":"contributing/#modifications-to-the-example-configuration-for-developers","title":"Modifications to the example configuration for developers","text":"<p>The chapter describes each configuration option for d\u0361jehuty. The remainder of sections here contain a fast-path through configuring d\u0361jehuty for use in a development setup.</p>"},{"location":"contributing/#live-reload","title":"Live reload","text":"<p>The d\u0361jehuty program can be configured to automatically reload itself when a change is detected by setting l\u0361ive-reload to 1\u0361.</p>"},{"location":"contributing/#configuring-authentication-with-orcid","title":"Configuring authentication with ORCID","text":"<p>The d\u0361jehuty program does not have Identity Provider (IdP) capabilities, so in order to log into the system we must configure an external IdP. With an ORCID account comes the ability to set up an OAuth endpoint. Go to developer-tools at orcid.org. When setting up the OAuth at ORCID, choose h\u0361ttp://127.0.0.1:8080/login as redirect URI.</p> <p>Modify the following bits to reflect the settings obtained from ORCID.</p> <pre><code>&lt;authentication&gt;\n    &lt;orcid&gt;\n      &lt;client-id&gt;APP-XXXXXXXXXXXXXXXX&lt;/client-id&gt;\n      &lt;client-secret&gt;XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX&lt;/client-secret&gt;\n      &lt;endpoint&gt;https://orcid.org/oauth&lt;/endpoint&gt;\n    &lt;/orcid&gt;\n  &lt;/authentication&gt;\n</code></pre> <p>To limit who can log into a development system, accounts are not automatically created for ORCID as IdP. So we need to configure who can log in by creating a record in the p\u0361rivileges section of the configuration file.</p> <p>This is also a good moment to configure additional privileges for your account. In the following snippet, configure the ORCID with which you will log into the system in the o\u0361rcid argument.</p> <pre><code>&lt;privileges&gt;\n    &lt;account email=\"you@example.com\" orcid=\"0000-0000-0000-0001\"&gt;\n      &lt;may-administer&gt;1&lt;/may-administer&gt;\n      &lt;may-impersonate&gt;1&lt;/may-impersonate&gt;\n      &lt;may-review&gt;1&lt;/may-review&gt;\n    &lt;/account&gt;\n  &lt;/privileges&gt;\n</code></pre>"},{"location":"contributing/#invoking-djehuty","title":"Invoking d\u0361jehuty","text":"<p>Once we\u2019ve configured d\u0361jehuty for development use, we can start the web interface by running:</p> <pre><code>[env]$ djehuty web --initialize --config-file=config.xml\n</code></pre> <p>The -\u0361-initialize option creates the internal account record and associates the specified ORCID with it. We only need to run d\u0361jehuty with the -\u0361-initialize option once.</p> <p>By now, we should be able to visit d\u0361jehuty through a web browser at localhost:8080, unless configured differently. We should be able to log in through ORCID, and access all features of d\u0361jehuty.</p>"},{"location":"contributing/#navigating-the-source-code","title":"Navigating the source code","text":"<p>In this section, we trace the path from invoking d\u0361jehuty to responding to a HTTP request.</p>"},{"location":"contributing/#starting-point","title":"Starting point","text":"<p>Because d\u0361jehuty is installable as a Python package, we can find the starting point for running d\u0361jehuty in p\u0361yproject.toml. It reads:</p> <pre><code>[project.scripts]\ndjehuty = djehuty.ui:main\n</code></pre> <p>So, we start our tour at in the procedure called m\u0361ain.</p>"},{"location":"contributing/#how-djehuty-initializes","title":"How d\u0361jehuty initializes","text":"<p>The m\u0361ain procedure calls m\u0361ain_inner, which handles the command-line arguments. When invoking d\u0361jehuty, we usually invoke d\u0361jehuty web, which is handled by the following snippet:</p> <pre><code>import djehuty.web.ui as web_ui\n...\nif args.command == \"web\":\n    web_ui.main (args.config_file, True, args.initialize,\n                 args.extract_transactions_from_log,\n                 args.apply_transactions)\n</code></pre> <p>So, the entry-point for the w\u0361eb subcommand is found in s\u0361rc/djehuty/web/ui.py at the m\u0361ain procedure.</p> <p>This procedure essentially sets up an instance of A\u0361piServer (found in s\u0361rc/djehuty/web/wsgi.py and uses w\u0361erkzeug\u2019s r\u0361un_simple to start the web server.</p>"},{"location":"contributing/#translating-uri-paths-to-internal-procedures","title":"Translating URI paths to internal procedures","text":"<p>An instance of the A\u0361piServer is passed along in werkzeug\u2019s r\u0361un_simple procedure. Werkzeug calls the instance directly, which is handled by the _\u0361_call__ procedure of the A\u0361piServer class. The _\u0361_call__ procedure invokes its w\u0361sgi instance, which is configured as following:</p> <pre><code>self.wsgi = SharedDataMiddleware(self.__respond, self.static_roots)\n</code></pre> <p>The _\u0361_respond procedure calls _\u0361_dispatch_request</p> <p>In _\u0361_dispatch_request, the requested URI is translated into the procedure name using the u\u0361rl_map. So, except for static resources in the s\u0361rc/djehuty/web/resources folder and pre-configured static pages, URIs are handled by a procedure in the A\u0361piServer instance.</p> <p>A mapping between a URI and the procedure that is executed to handle the request to that URI can be found in the u\u0361rl_map defined in the A\u0361piServer class in .</p>"},{"location":"contributing/#diving-into-the-code-that-displays-the-homepage","title":"Diving into the code that displays the homepage","text":"<p>As an example, in the u\u0361rl_map, we can find the following line:</p> <pre><code>R(\"/\", self.ui_home),\n</code></pre> <p>In this case, s\u0361elf is a reference to an instance of the A\u0361piServer class, so we look for a procedure called u\u0361i_home inside the A\u0361piServer class. Some code editors have a feature to \u201cgo to definition\u201d which helps navigating.</p> <p>The u\u0361i_home gathers the summary numbers from the SPARQL endpoint with the following line:</p> <pre><code>summary_data = self.db.repository_statistics()\n</code></pre> <p>And a list of the latest datasets with the following line:</p> <pre><code>records = self.db.latest_datasets_portal(30)\n</code></pre> <p>It then passes that information to the _\u0361_render_template procedure which renders the in the folder. The Jinja [^1] package is used to interpret the template.</p> <pre><code>return self.__render_template (request, \"portal.html\",\n                               summary_data = summary_data,\n                               latest = records, ...)\n</code></pre>"},{"location":"contributing/#database-communication","title":"Database communication","text":"<p>In the u\u0361i_home procedure, we found a call to the s\u0361elf.db.repository_statistics procedure. To find out by hand where that procedure can be found, we can look for the place where s\u0361elf.db is assigned a value:</p> <pre><code>self.db = database.SparqlInterface()\n</code></pre> <p>And from there look up where d\u0361atabase comes from:</p> <pre><code>from djehuty.web import database\n</code></pre> <p>From which we can conclude that it can be found in .</p> <p>In the r\u0361epository_statistics procedure, we find a call to s\u0361elf.__query_from_template followed by a call to _\u0361_run_query which takes the output of the former procedure as its input.</p> <p>As the name implies, _\u0361_run_query sends the query to the SPARQL endpoint and retrieves the results by putting them in a list of Python dictionaries.</p> <p>The s\u0361elf.__query_from_template procedure takes one parameter, which is the name of the template file (minus the extension) that contains a SPARQL query. These templates can be found in the folder.</p> <p>[^1]:</p>"},{"location":"introduction/","title":"Introduction","text":"<p>is the data repository system developed by and for 4TU.ResearchData. The name finds its inspiration in Thoth, the Egyptian entity that introduced the idea of writing.</p>"},{"location":"introduction/#obtaining-the-source-code","title":"Obtaining the source code","text":"<p>The source code can be downloaded at the Releases ^1 page. Make sure to download the djehuty-.tar.gz file.</p> <p>Or, directly download the tarball using the command-line:</p> <pre><code>curl -LO https://github.com/4TUResearchData/djehuty/releases/\\(@*\\\\*@)download/v(@*\\djehutyversion{}*@)/djehuty-(@*\\djehutyversion{}*@).tar.gz\n</code></pre> <p>After obtaining the tarball, it can be unpacked using the t\u0361ar command:</p> <pre><code>tar zxvf djehuty-(@*\\djehutyversion{}*@).tar.gz\n</code></pre>"},{"location":"introduction/#installing-the-prerequisites","title":"Installing the prerequisites","text":"<p>The program needs Python (version 3.8 or higher) and Git to be installed. Additionally, a couple of Python packages need to be installed. The following sections describe installing the prerequisites on various GNU/Linux distributions. To put the software in the context of its environment:</p> <p></p> <p>The web service of stores its information in a SPARQL 1.1 endpoint. We recommend either Blazegraph ^2 or Virtuoso open-source edition ^3.</p>"},{"location":"introduction/#installation-on-enterprise-linux-7","title":"Installation on Enterprise Linux 7+","text":"<p>The Python packages on Enterprise Linux version 7 or higher seem to be too far out of date. So installing the prerequisites involves two steps.</p> <p>The first step involves installing system-wide packages for Python and Git.</p> <pre><code>yum install python39 git\n</code></pre> <p>The second step involves using Python\u2019s v\u0361env module to install the Python packages in a virtual environment:</p> <pre><code>python3.9 -m venv djehuty-env\n. djehuty-env/bin/activate\ncd /path/to/the/repository/checkout/root\npip install -r requirements.txt\n</code></pre>"},{"location":"introduction/#installation-instructions","title":"Installation instructions","text":"<p>After obtaining the source code (see section ) and installing the required tools (see section ), building involves running the following commands:</p> <pre><code>cd djehuty-(@*\\djehutyversion{}*@)\nautoreconf -vif # Only needed if the \"./configure\" step does not work.\n./configure\nmake\nmake install\n</code></pre> <p>To run the m\u0361ake install command, super user privileges may be required. Specify a -\u0361-prefix to the c\u0361onfigure script to install the tools to a user-writeable location to avoid needing super user privileges.</p> <p>After installation, the d\u0361jehuty program will be available.</p>"},{"location":"introduction/#pre-built-containers","title":"Pre-built containers","text":"<p>4TU.ResearchData provides Docker container images as a convenience service for each monthly d\u0361jehuty release. The following table outlines the meaning of each image provided. The images are published to Docker Hub [^4].</p> Image tag Description d\u0361evel Image meant for development purposes. Before it executes the d\u0361jehuty command it checks out the latest codebase. So re-running the same container image may result in running a different version of d\u0361jehuty. l\u0361atest This image points to the latest d\u0361jehuty release. It does not automatically update the d\u0361jehuty codebase. X\u0361X.X 4TU.ResearchData releases a version each month where the number before the dot refers to the year and the number after the dot refers to the month. Use a specific version image when you want to upgrade at your own pace. <p>To build the container images for yourself, see the build instructions in the file.</p> <p>[^4]:</p>"},{"location":"knowledge-graph/","title":"Knowledge graph","text":"<p>djehuty processes its information using the Resource Description Framework (Lassila,\u00a01999). This chapter describes the parts that make up the data model of djehuty.</p>"},{"location":"knowledge-graph/#31-use-of-vocabularies","title":"3.1  Use of vocabularies","text":"<p>Throughout this chapter, abbreviated references to ontologies are used. Table 3.1 lists these abbreviations.</p> <p>| Abbreviation | Ontology URI | | djht | https://ontologies.data.4tu.nl/djehuty/24.10.1/ | | rdf | http://www.w3.org/1999/02/22-rdf-syntax-ns# | | rdfs | http://www.w3.org/2000/01/rdf-schema# | | xsd | http://www.w3.org/2001/XMLSchema# | |  |</p> <p>Table\u00a03.1: Lookup table for vocabulary URIs and their abbreviations. \u00a0\u00a0</p>"},{"location":"knowledge-graph/#32-notational-shortcuts","title":"3.2  Notational shortcuts","text":"<p>In addition to abbreviating ontologies with their prefix we use another notational shortcut. To effectively communicate the structure of the RDF graph used by djehuty we introduce a couple of shorthand notations.</p>"},{"location":"knowledge-graph/#321-notation-for-typed-triples","title":"3.2.1  Notation for typed triples","text":"<p>When the object in a triple is typed, we introduce the shorthand to only show the type, rather than the actual value of the object. Figure 3.1 displays this for URIs, and figure 3.2 displays this for literals.</p> <p></p> <p>Figure\u00a03.1: Shorthand notation for triples with an rdf:type which features a hollow predicate arrow and a colored type specifier with rounded corners. \u00a0\u00a0</p> <p>Literals are depicted by rectangles (with sharp edges) in contrast to URIs which are depicted as rectangles with rounded edges.</p> <p></p> <p>Figure\u00a03.2: Shorthand notation for triples with a literal, which features a hollow predicate arrow and a colored rectangular type specifier. \u00a0\u00a0</p> <p>When the subject of a triple is the shorthand type, assume the subject is not the type itself but the subject which has that type.</p>"},{"location":"knowledge-graph/#322-notation-for-rdflist","title":"3.2.2  Notation for rdf:List","text":"<p>To preserve the order in which lists were formed, the data model makes use of rdf:List with numeric indexes. This pattern will be abbreviated in the remainder of the figures as displayed in figure 3.3.</p> <p></p> <p>Figure\u00a03.3: Shorthand notation for rdf:List with numeric indexes, which features a hollow double-arrow. Lists have arbitrary lengths, and the numeric indexes use 1-based indexing. \u00a0\u00a0</p> <p>The hollow double-arrow depicts the use of an rdf:List with numeric indexes.</p>"},{"location":"knowledge-graph/#33-datasets","title":"3.3  Datasets","text":"<p>Datasets play a central role in the repository system because every other type links in one way or another to it. The user submits files along with data about those bytes as a single record which we call a djht:Dataset. Figure 3.4 shows how the remainder of types in this chapter relate to a djht:Dataset.</p> <p></p> <p>Figure\u00a03.4: The RDF pattern for a djht:Dataset. For a full overview of djht:Dataset properties, use the exploratory from the administration panel. \u00a0\u00a0</p> <p>Datasets are versioned records. The data and metadata between versions can differ, except all versions of a dataset share an identifier. We use djht:DatasetContainer to describe the version-unspecific properties of a set of versioned datasets.</p> <p></p> <p>Figure\u00a03.5: The RDF pattern for a djht:DatasetContainer. All versions of a dataset share a djht:dataset_id and a UUID in the container URI. \u00a0\u00a0</p> <p>The data model follows a natural expression of published versions as a linked list. Figure 3.5 further reveals that the view, download, share and citation counts are stored in a version-unspecific way.</p>"},{"location":"knowledge-graph/#34-accounts","title":"3.4  Accounts","text":"<p>djehuty uses an external identity provider, but stores an e-mail address, full name, and preferences for categories.</p> <p></p> <p>Figure\u00a03.6: The RDF pattern for an djht:Account. \u00a0\u00a0</p>"},{"location":"knowledge-graph/#35-funding","title":"3.5  Funding","text":"<p>When the djht:Dataset originated out of a funded project, the funders can be listed using djht:Funding. Figure 3.7 displays the details for this structure.</p> <p></p> <p>Figure\u00a03.7: The RDF pattern for a djht:Funding. \u00a0\u00a0</p>"},{"location":"running-djehuty/","title":"Configuring","text":"<p>Now that is installed, it\u2019s a good moment to look into its run-time configuration options. All configuration can be done through a configuration file, for which an example is available at .</p>"},{"location":"running-djehuty/#essential-options","title":"Essential options","text":"Option Description b\u0361ind-address The address to bind a TCP socket on. p\u0361ort The port to bind a TCK socket on. b\u0361ase-url The URL on which the instance will be available to the outside world. a\u0361llow-crawlers Set to 1 to allow crawlers in the r\u0361obots.txt, otherwise set to 0. p\u0361roduction Performs extra checks before starting. Enable this when running a production instance. l\u0361ive-reload When set to 1, it reloads Python code on-the-fly. We recommend to set it to 0 when running in production. d\u0361ebug-mode When set to 1, it will display backtraces and error messages in the web browser. When set to 0, it will only show backtraces and error messages in the web browser. u\u0361se-x-forwarded-for When running d\u0361jehuty behind a reverse-proxy server, use the HTTP header X\u0361-Forwarded-For to log IP address information. d\u0361isable-collaboration When set to 1, it disables the \u201ccollaborators\u201d feature. a\u0361llowed-depositing-domains When unset, any authenticated user may deposit data. Otherwise, this option limits the ability to deposit to users with an e-mail address of the listed domain names. c\u0361ache-root d\u0361jehuty can cache query responses to lower the load on the database server. Specify the directory where to store cache files. This element takes an attribute c\u0361lear-on-start, and when set to 1, it will remove all cache files on start-up of d\u0361jehuty. p\u0361rofile-images-root Users can upload a profile image in d\u0361jehuty. This option should point to a filesystem directory where these profile images can be stored. d\u0361isable-2fa Accounts with privileges receive a code by e-mail as a second factor when logging in. Setting this option to 1 disables the second factor authentication. s\u0361andbox-message Display a message on the top of every page. n\u0361otice-message Display a message on the main page. m\u0361aintenance-mode When set to 1, all HTTP requests result in the displayment of a maintenance message. Use this option while backing up the database, or when performing major updates."},{"location":"running-djehuty/#configuring-the-database","title":"Configuring the Database","text":"<p>The d\u0361jehuty program stores its state in a SPARQL 1.1 compliant RDF store. Configuring the connection details is done in the r\u0361df-store node.</p> Option Description s\u0361tate-graph The graph name to store triplets in. s\u0361parql-uri The URI at which the SPARQL 1.1 endpoint can be reached. When the s\u0361parql-uri begins with b\u0361db://, followed by a path to a filesystem directory, it will use the BerkeleyDB back-end, for which the Python package needs to be installed. s\u0361parql-update-uri The URI at which the SPARQL 1.1 Update endpoint can be reached (in case it is different from the s\u0361parql-uri."},{"location":"running-djehuty/#audit-trails-and-database-reconstruction","title":"Audit trails and database reconstruction","text":"<p>The d\u0361jehuty program can keep an audit log of all database modifications made by itself from which a database state can be reconstructed. Whether d\u0361jehuty keeps such an audit log can be configured with the following option:</p> Option Description e\u0361nable-query-audit-log When set to 1, it writes every SPARQL query that modifies the database in the web logs. This can be replayed to reconstruct the database at a later time. Setting this option to 0 disables this feature. This element takes an attribute t\u0361ransactions-directory that should specify an empty directory to which transactions can be written that are extracted from the audit log."},{"location":"running-djehuty/#reconstructing-the-database-from-the-query-audit-log","title":"Reconstructing the database from the query audit log","text":"<p>Each query that modifies the database state while the query audit logs are enabled can be extracted from the query audit log using the -\u0361-extract-transactions-from-log command-line option. A timestamp to specify the starting point to extract from can be specified as an argument. The following example displays its use:</p> <pre><code>djehuty web --config-file=config.xml --extract-transactions-from-log=\"YYYY-MM-DD HH:MM:SS\"\n</code></pre> <p>This will create a file for each query in the folder specified in the t\u0361ransactions-directory attribute.</p> <p>To replay the extracted transactions, use the a\u0361pply-transactions command-line option:</p> <pre><code>djehuty web --config-file=config.xml --apply-transactions\n</code></pre> <p>When a query cannot be executed, the command stops, allowing to fix or remove the query to-be-replayed. Invoking the -\u0361-apply-transactions command a second time will continue replaying where the previous run stopped.</p>"},{"location":"running-djehuty/#configuring-storage","title":"Configuring storage","text":"<p>Storage locations can be configured with the s\u0361torage node. When configuring multiple locations, d\u0361jehuty attempts to find a file by looking at the first configured location, and in case it cannot find the file there, it will look at the second configured location, and so on, until it has tried each storage location.</p> <p>This allows for moving files between storage systems transparently without requiring specific interactions with d\u0361jehuty other than having the files made available as a POSIX filesystem.</p> <p>One use-case that suits this mechanism is letting uploads write to fast online storage and later move the uploaded files to a slower but less costly storage.</p> Option Description l\u0361ocation A filesystem path to where files are stored. This is a repeatable property."},{"location":"running-djehuty/#configuring-an-identity-provider","title":"Configuring an identity provider","text":"<p>Ideally, d\u0361jehuty makes use of an external identity provider. d\u0361jehuty can use SAML2.0, ORCID, or an internal identity provider (for testing and development purposes only).</p> <p>This section will outline the configuration options for each identity provision mechanism.</p>"},{"location":"running-djehuty/#saml20","title":"SAML2.0","text":"<p>For SAML 2.0, the configuration can be placed in the s\u0361aml section under a\u0361uthentication. That looks as following:</p> <pre><code>&lt;authentication&gt;\n  &lt;saml version=\"2.0\"&gt;\n    &lt;!-- Configuration goes here. --&gt;\n  &lt;/saml&gt;\n&lt;/authentication&gt;\n</code></pre> <p>The options outlined in the remainder of this section should be placed where the example shows .</p> Option Description s\u0361trict When set to 1, SAML responses must be signed. Never disable \u2018strict\u2019 mode in a production environment. d\u0361ebug Increases logging verbosity for SAML-related messages. a\u0361ttributes In this section the attributes provided by the identity provider can be aligned to the attributes d\u0361jehuty expects. s\u0361ervice-provider The d\u0361jehuty program fulfills the role of service provider. In this section the certificate and service provider metadata can be configured. i\u0361dentity-provider In this section the certificate and single-sign-on URL of the identity provider can be configured. s\u0361ram In this section, SURF Research Access Management-specific attributes can be configured."},{"location":"running-djehuty/#the-attributes-configuration","title":"The a\u0361ttributes configuration","text":"<p>To create account and author records and to authenticate a user, d\u0361jehuty stores information provided by the identity provider. Each identity provider may provide this information using different attributes. Therefore, the translation from attributes used by d\u0361jehuty and attributes given by the identity provider can be configured. The following attributes must be configured.</p> Option Description f\u0361irst-name A user\u2019s first name. l\u0361ast-name A user\u2019s last name. c\u0361ommon-name A user\u2019s full name. e\u0361mail A user\u2019s e-mail address. g\u0361roups The attribute denoting groups. g\u0361roup-prefix The prefix for each group short name. <p>As an example, the attributes configuration for SURFConext looks like this:</p> <pre><code>&lt;attributes&gt;\n  &lt;first-name&gt;urn:mace:dir:attribute-def:givenName&lt;/first-name&gt;\n  &lt;last-name&gt;urn:mace:dir:attribute-def:sn&lt;/last-name&gt;\n  &lt;common-name&gt;urn:mace:dir:attribute-def:cn&lt;/common-name&gt;\n  &lt;email&gt;urn:mace:dir:attribute-def:mail&lt;/email&gt;\n&lt;/attributes&gt;\n</code></pre> <p>And for SURF Research Access Management (SRAM), the attributes configuration looks like this:</p> <pre><code>&lt;attributes&gt;\n  &lt;first-name&gt;urn:oid:2.5.4.42&lt;/first-name&gt;\n  &lt;last-name&gt;urn:oid:2.5.4.4&lt;/last-name&gt;\n  &lt;common-name&gt;urn:oid:2.5.4.3&lt;/common-name&gt;\n  &lt;email&gt;urn:oid:0.9.2342.19200300.100.1.3&lt;/email&gt;\n  &lt;groups&gt;urn:oid:1.3.6.1.4.1.5923.1.1.1.7&lt;/groups&gt;\n  &lt;group-prefix&gt;urn:mace:surf.nl:sram:group:[organisation]:[service]&lt;/group-prefix&gt;\n&lt;/attributes&gt;\n</code></pre>"},{"location":"running-djehuty/#the-sram-configuration","title":"The s\u0361ram configuration","text":"<p>When using SURF Research Access Management (SRAM), d\u0361jehuty can persuade SRAM to send an invitation to anyone inside or outside the institution to join the SRAM collaboration that provides access to the d\u0361jehuty instance. To do so, the following attributes must be configured.</p> Option Description o\u0361rganization-api-token An organization-level API token. c\u0361ollaboration-id The UUID of the collaboration to invite users to."},{"location":"running-djehuty/#the-service-provider-configuration","title":"The s\u0361ervice-provider configuration","text":"Option Description x\u0361509-certificate Contents of the public certificate without whitespacing. p\u0361rivate-key Contents of the private key belonging to the x\u0361509-certificate to sign messages with. m\u0361etadata This section contains metadata that may be displayed by the identity provider to users before authorizing them. d\u0361isplay-name The name to be displayed by the identity provider when authorizing the user to the service. u\u0361rl The URL to the service. d\u0361escription Textual description of the service. o\u0361rganization This section contains metadata to describe the organization behind the service. n\u0361ame The name of the service provider\u2019s organization. u\u0361rl The URL to the web page of the organization. c\u0361ontact A repeatable section to list contact persons and their roles within the organization. The role can be configured by setting the t\u0361ype attribute. f\u0361irst-name The first name of the contact person. l\u0361ast-name The last name of the contact person. e\u0361mail The e-mail address of the contact person. Note that some identity providers prefer functional e-mail addresses (e.g. support@... instead of jdoe@...)."},{"location":"running-djehuty/#orcid","title":"ORCID","text":"<p>ORCID.org plays a key role in making researchers findable. Its identity provider service can be used by d\u0361jehuty in two ways:</p> <ol> <li> <p>As primary identity provider to log in and deposit data;</p> </li> <li> <p>As additional identity provider to couple an author record to its     ORCID record.</p> </li> </ol> <p>When another identity provider is configured in addition to ORCID, that identity provider will be used as primary and ORCID will only be used to couple author records to the author\u2019s ORCID record.</p> <p>To configure ORCID, the configuration can be placed in the o\u0361rcid section under a\u0361uthentication. That looks as following:</p> <pre><code>&lt;authentication&gt;\n  &lt;orcid&gt;\n    &lt;!-- Configuration goes here. --&gt;\n  &lt;/orcid&gt;\n&lt;/authentication&gt;\n</code></pre> <p>Then the following parameters can be configured:</p> Option Description c\u0361lient-id The client ID provided by ORCID. c\u0361lient-secret The client secret provided by ORCID. e\u0361ndpoint The URL to the ORCID endpoint to use."},{"location":"running-djehuty/#configuring-an-e-mail-server","title":"Configuring an e-mail server","text":"<p>On various occassions, d\u0361jehuty will attempt to send an e-mail to either an author, a reviewer or an administrator. To be able to do so, an e-mail server must be configured from which the instance may send e-mails.</p> <p>The configuration is done under the e\u0361mail node, and the following items can be configured:</p> Option Description s\u0361erver Address of the e-mail server without protocol specification. p\u0361ort The port the e-mail server operates on. s\u0361tarttls When 1, d\u0361jehuty attempts to use StartTLS. u\u0361sername The username to authenticate with to the e-mail server. p\u0361assword The password to authenticate with to the e-mail server. f\u0361rom The e-mail address used to send e-mail from. s\u0361ubject-prefix Text to prefix in the subject of all e-mails sent from the instance of d\u0361jehuty. This can be used to distinguish a test instance from a production instance."},{"location":"running-djehuty/#configuring-doi-registration","title":"Configuring DOI registration","text":"<p>When publishing a dataset or collection, d\u0361jehuty can register a persistent identifier with DataCite. To enable this feature, configure it under the d\u0361atacite node. The following parameters can be configured:</p> Option Description a\u0361pi-url The URL of the API endpoint of DataCite. r\u0361epository-id The repository identifier given by DataCite. p\u0361assword The password to authenticate with to DataCite. p\u0361refix The DOI prefix to use when registering a DOI."},{"location":"running-djehuty/#configuring-handle-registration","title":"Configuring Handle registration","text":"<p>Each uploaded file can be assigned a persistent identifier using the Handle system. To enable this feature, configure it under the h\u0361andle node. The following parameters can be configured:</p> Option Description u\u0361rl The URL of the API endpoint of the Handle system implementor. c\u0361ertificate Certificate to use for authenticating to the endpoint. p\u0361rivate-key The private key paired with the certificate used to authenticate to the endpoint. p\u0361refix The Handle prefix to use when registering a handle. i\u0361ndex The index to use when registering a handle."},{"location":"running-djehuty/#configuring-iiif-support","title":"Configuring IIIF support","text":"<p>When publishing images, d\u0361jehuty can enable the IIIF Image API for the images. It uses l\u0361ibvips and p\u0361yvips under the hood to perform image manipulation. The following parameters can be configured:</p> Option Description e\u0361nable-iiif Enable support for the IIIF image API. This requires the p\u0361yvips package to be available in the run-time environment. i\u0361iif-cache-root The directory to store the output of IIIF Image API requests to avoid re-computing the image."},{"location":"running-djehuty/#customizing-looks","title":"Customizing looks","text":"<p>With the following options, the instance can be branded as necessary.</p> Option Description s\u0361ite-name Name for the instance used in the title of a browser window and as default value in the publisher field for new datasets. s\u0361ite-description Description used as a meta-tag in the HTML output. s\u0361ite-shorttag Used as keyword and as Git remote name. s\u0361upport-email-address E-mail address used in e-mails sent to users in automated messages. c\u0361ustom-logo-path Path to a PNG image file that will be used as logo on the website. c\u0361ustom-favicon-path Path to an ICO file that will be used as favicon. s\u0361mall-footer HTML that will be used as footer for all pages except for the main page. l\u0361arge-footer HTML that will be used as footer on the main page. s\u0361how-portal-summary When set to 1, it shows the repository summary of number of datasets, authors, collections, files and bytes on the main page. s\u0361how-institutions When set to 1, it shows the list of institutions on the main page. s\u0361how-science-categories When set to 1, it shows the subjects (categories) on the main page. s\u0361how-latest-datasets When set to 1, it shows the list of latest published datasets on the main page. c\u0361olors Colors used in the HTML output. See section &lt;a href=\"#sec:customize-colors\" data-reference-type=\"ref\" data-reference=\"sec:customize-colors\"&gt;1.10.1."},{"location":"running-djehuty/#customizing-colors","title":"Customizing colors","text":"<p>The following options can be configured in the c\u0361olors section.</p> Option Description p\u0361rimary-color The main background color to use. p\u0361rimary-foreground-color The main foreground color to use. p\u0361rimary-color-hover Color to use when hovering a link. p\u0361rimary-color-active Color to use when a link is clicked. p\u0361rivilege-button-color The background color of buttons for privileged actions. f\u0361ooter-background-color Color to use in the footer."},{"location":"running-djehuty/#configuring-privileged-users","title":"Configuring privileged users","text":"<p>By default an authenticated user may deposit data. But users can have additional roles; for example: a dataset reviewer, a technical administrator or a quota reviewer.</p> <p>Such additional roles are configured in terms of privileges. The following privileges can be configured in the p\u0361rivileges section:</p> Option Description m\u0361ay-administer Allows access to perform maintenance tasks, view accounts and view reports on restricted and embargoed datasets. m\u0361ay-run-sparql-queries Allows to run arbitrary SPARQL queries on the database. m\u0361ay-impersonate Allows to log in to any account and therefore perform any action as that account. m\u0361ay-review Allows to see which datasets are sent for review, and allows to perform reviews. m\u0361ay-review-quotas Allows access to see requests for storage quota increases and approve or decline them. m\u0361ay-review-integrity Allows access to an API call that provides statistics on the accessibility of files on the filesystem. m\u0361ay-process-feedback Accounts with this privilege will receive e-mails with the information entered into the feedback form by other users. m\u0361ay-receive-email-notifications This \u201cprivilege\u201d can be used to disable sending any e-mails to an account by setting it to 0\u0361. The default is 1\u0361. <p>To enable a privilege for an account, set the value of the desired privilege to 1\u0361. Privileges are disabled by default, except for m\u0361ay-receive-email-notifications which defaults to 1\u0361.</p> <pre><code>&lt;privileges&gt;\n    &lt;account email=\"you@example.com\" orcid=\"0000-0000-0000-0001\"&gt;\n      &lt;may-administer&gt;1&lt;/may-administer&gt;\n      &lt;may-run-sparql-queries&gt;1&lt;/may-run-sparql-queries&gt;\n      &lt;may-impersonate&gt;1&lt;/may-impersonate&gt;\n      &lt;may-review&gt;0&lt;/may-review&gt;\n      &lt;may-review-quotas&gt;0&lt;/may-review-quotas&gt;\n      &lt;may-review-integrity&gt;0&lt;/may-review-integrity&gt;\n      &lt;may-process-feedback&gt;0&lt;/may-process-feedback&gt;\n      &lt;may-receive-email-notifications&gt;1&lt;/may-receive-email-notifications&gt;\n    &lt;/account&gt;\n  &lt;/privileges&gt;\n</code></pre>"}]}